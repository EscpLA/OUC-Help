(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/me-signUp/me-signUp"],{201:function(e,t,r){"use strict";r.r(t);var n=r(202),a=r(204);for(var o in a)"default"!==o&&function(e){r.d(t,e,(function(){return a[e]}))}(o);r(206);var s,u=r(48),i=Object(u["default"])(a["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],s);i.options.__file="components/me-signUp/me-signUp.vue",t["default"]=i.exports},202:function(e,t,r){"use strict";r.r(t);var n=r(203);r.d(t,"render",(function(){return n["render"]})),r.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),r.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),r.d(t,"components",(function(){return n["components"]}))},203:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"render",(function(){return a})),r.d(t,"staticRenderFns",(function(){return s})),r.d(t,"recyclableRender",(function(){return o})),r.d(t,"components",(function(){return n}));try{n={uniDataPicker:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uni-data-picker/components/uni-data-picker/uni-data-picker")]).then(r.bind(null,286))}}}catch(u){if(-1===u.message.indexOf("Cannot find module")||-1===u.message.indexOf(".vue"))throw u;console.error(u.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var a=function(){var e=this,t=e.$createElement;e._self._c},o=!1,s=[];a._withStripped=!0},204:function(e,t,r){"use strict";r.r(t);var n=r(205),a=r.n(n);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},205:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(51)),a=(s(r(49)),s(r(88))),o=r(45);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r,n,a,o,s){try{var u=e[o](s),i=u.value}catch(c){return void r(c)}u.done?t(i):Promise.resolve(i).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){u(o,n,a,s,i,"next",e)}function i(e){u(o,n,a,s,i,"throw",e)}s(void 0)}))}}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f={name:"me-signUp",data:function(){return{avatarUrl:"https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0",tempAvatarUrl:"",md5Arr:[],nickName:"",stuNumber:"",grade:"",major:"",tele:"",grades:[{value:1,text:"2019级"},{value:2,text:"2020级"},{value:3,text:"2021级"},{value:4,text:"2022级"}],majors:[{value:0,text:"数据科学与大数据i技术"}],gradeID:-1,majorID:-1,map:{text:"grade",value:"id"}}},computed:l({},(0,o.mapState)("m_user",["token"])),methods:l(l({},(0,o.mapMutations)("m_user",["updateSignUp","updateStuInfo","updateMandG"])),{},{getGradeAndMajor:function(){var t=this;return i(n.default.mark((function r(){var a,o;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.$http.post("/GradeAndMajor/");case 2:a=r.sent,o=a.data,console.log("res",o),t.$data.grades=o.grade,t.$data.majors=o.majorlist,t.updateMandG(o);case 8:case"end":return r.stop()}}),r)})))()},save:function(t){this.nickName=t.detail.value.nickName;var r=/^\d{8,12}$/,n=/^([1][3,4,5,6,7,8,9])\d{9}$/;return""==this.tempAvatarUrl?e.$showMsg("请选择头像"):""==this.nickName?e.$showMsg("请输入昵称"):0==r.test(this.stuNumber)?e.$showMsg("学号不符合规范"):0==n.test(this.tele)?e.$showMsg("请输入合法的电话号码"):void this.uploadImg()},submit:function(){var t=this;return i(n.default.mark((function r(){var a,o,s;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={nickName:t.$data.nickName,phone:t.$data.tele,student_number:t.$data.stuNumber,openid:t.token,depart_majorID:t.$data.majorID+"",depart_gradeID:t.$data.gradeID+"",depart_picture:t.avatarUrl},console.log("query",a),r.next=4,e.$http.post("/register/",a);case 4:if(o=r.sent,s=o.data,console.log("res",s),200!==s.code){r.next=13;break}return t.updateStuInfo(s.stuInfo[0]),console.log("res.stuInfo[0]: ",s.stuInfo[0]),r.abrupt("return",e.$showMsg(s.msg));case 13:return r.abrupt("return",e.$showMsg(s.msg));case 14:case"end":return r.stop()}}),r)})))()},onGradeChange:function(e){void 0==e.detail.value[0]?this.$data.gradeID=-1:-1==this.$data.majorID&&this.$refs.majorPicker.show(),console.log("gradeId",this.$data.gradeID)},onMajorChange:function(e){void 0==e.detail.value[0]&&(this.$data.majorID=-1)},onChooseAvatar:function(e){var t=e.detail.avatarUrl;this.avatarUrl=t,this.tempAvatarUrl=t,this.md5Arr.push(a.default.hex_md5(this.tempAvatarUrl)),console.log("this.md5Arr: ",this.md5Arr),console.log("this.tempAvatarUrl: ",this.tempAvatarUrl)},uploadImg:function(){var t=this;return i(n.default.mark((function r(){var a,o,s,u,i,c,l,d;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log("-----------uploadImg()---------"),a="https://dryang-miniapp.oss-accelerate.aliyuncs.com",r.next=4,e.$http.post("/get_token/");case 4:o=r.sent,s=o.data,u=s.result.host,i=s.result.signature,c=s.result.AccessKeyId,l=s.result.policy,console.log("res",s),d="ouchelp/"+t.md5Arr[0]+t.tempAvatarUrl.split(".")[1],e.uploadFile({url:u,filePath:t.tempAvatarUrl,name:"file",formData:{key:d,policy:l,ossAccessKeyId:c,signature:i},success:function(e){204===e.statusCode?(t.avatarUrl=a+"/"+d,console.log("this.avatarUrl: ",t.avatarUrl),t.submit()):(console.log("请求成功，但是上传失败！"),reject("请求成功，但是上传失败！"))},fail:function(e){console.log("请求失败！"),reject("请求失败！")}});case 13:case"end":return r.stop()}}),r)})))()}}),created:function(){this.getGradeAndMajor()}};t.default=f}).call(this,r(1)["default"])},206:function(e,t,r){"use strict";r.r(t);var n=r(207),a=r.n(n);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},207:function(e,t,r){}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/components/me-signUp/me-signUp.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/me-signUp/me-signUp-create-component',
    {
        'components/me-signUp/me-signUp-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(201))
        })
    },
    [['components/me-signUp/me-signUp-create-component']]
]);
